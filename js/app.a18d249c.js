(function(t){function n(n){for(var r,a,s=n[0],c=n[1],u=n[2],f=0,v=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&v.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(n);while(v.length)v.shift()();return o.push.apply(o,u||[]),e()}function e(){for(var t,n=0;n<o.length;n++){for(var e=o[n],r=!0,s=1;s<e.length;s++){var c=e[s];0!==i[c]&&(r=!1)}r&&(o.splice(n--,1),t=a(a.s=e[0]))}return t}var r={},i={app:0},o=[];function a(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=t,a.c=r,a.d=function(t,n,e){a.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,n){if(1&n&&(t=a(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)a.d(e,r,function(n){return t[n]}.bind(null,r));return e},a.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(n,"a",n),n},a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var u=0;u<s.length;u++)n(s[u]);var l=c;o.push([0,"chunk-vendors"]),e()})({0:function(t,n,e){t.exports=e("56d7")},"135e":function(t,n,e){"use strict";var r=e("dd9d"),i=e.n(r);i.a},"56d7":function(t,n,e){"use strict";e.r(n);e("cadf"),e("551c"),e("f751"),e("097d");var r=e("2b0e"),i=function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",{attrs:{id:"app"}},[r("h1",[t._v("2D Ray March render")]),r("h2",[t._v("Please use Chrome. Somehow its faster.")]),r("p",[t._v("In this demo, refraction and reflection is disabled. It will draw the Aperture Science Logo from the game Portal:")]),r("img",{attrs:{src:e("ac8f"),alt:""}}),r("ray-canvas")],1)},o=[],a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{attrs:{id:"control"}},[e("div",[e("p",[t._v("Preset, the quicker, the lower the quality")]),e("button",{on:{click:function(n){return t.preset(0)}}},[t._v("Fast")]),e("button",{on:{click:function(n){return t.preset(1)}}},[t._v("Normal")]),e("button",{on:{click:function(n){return t.preset(2)}}},[t._v("Slow")]),e("button",{on:{click:function(n){return t.preset(3)}}},[t._v("Slowest")]),e("p",[t._v("Resolution of canvas. Recommend < 512 x 512")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.input_resolution,expression:"input_resolution"}],attrs:{type:"number",placeholder:"Resolution"},domProps:{value:t.input_resolution},on:{input:function(n){n.target.composing||(t.input_resolution=n.target.value)}}}),e("p",[t._v("Sample Count Per Pixel. Recommend 32")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.input_N,expression:"input_N"}],attrs:{type:"number",placeholder:"Sample Count"},domProps:{value:t.input_N},on:{input:function(n){n.target.composing||(t.input_N=n.target.value)}}}),e("p",[t._v("Ray March Iteration. Recommend < 8")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.input_MAX_STEP,expression:"input_MAX_STEP"}],attrs:{type:"number",placeholder:"Ray March Iteration"},domProps:{value:t.input_MAX_STEP},on:{input:function(n){n.target.composing||(t.input_MAX_STEP=n.target.value)}}})]),e("div",[e("button",{directives:[{name:"show",rawName:"v-show",value:t.showBtn,expression:"showBtn"}],on:{click:t.draw}},[t._v("Draw")]),e("button",{directives:[{name:"show",rawName:"v-show",value:!t.aborted,expression:"!aborted"}],on:{click:t.abort}},[t._v("Abort")])]),e("p",[t._v("To clean the canvas, please refresh this page")])]),e("div",{attrs:{id:"canvas"}},[e("canvas",{ref:"canvas"})])])},s=[],c=e("d225"),u=e("b0b4"),l=6.28318530718,f=1e-4,v=2,h=1e-6,p=8,d=8,m=2,g=256;function _(t,n,e,r,i){var o=t-e,a=n-r;return Math.sqrt(o*o+a*a)-i}function b(t,n,e,r,i,o){var a=t-e,s=n-r,c=i-e,u=o-r,l=Math.max(Math.min((a*c+s*u)/(c*c+u*u),1),0),f=a-c*l,v=s-u*l;return Math.sqrt(f*f+v*v)}function y(t,n,e,r,i,o,a,s){var c=Math.min(Math.min(b(t,n,e,r,i,o),b(t,n,i,o,a,s)),b(t,n,a,s,e,r));return(i-e)*(n-r)>(o-r)*(t-e)&&(a-i)*(n-o)>(s-o)*(t-i)&&(e-a)*(n-s)>(r-s)*(t-a)?-c:c}function w(t){return t.reduce((function(t,n){return x(t,n)}))}function x(t,n){return t.sd<n.sd?t:n}function M(t,n){var e=t.sd>n.sd?n:t;return e.sd=t.sd>n.sd?t.sd:n.sd,e}var P=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(c["a"])(this,t),this.sd=n,this.emissive=e,this.reflectivity=r,this.eta=i},S=2,I=.1*S,E=.18*S,N=.01*S;function T(t){return t*l/360}function O(t,n,e){var r=T(e),i=Math.cos(r),o=Math.sin(r),a=t*i+n*o,s=t*-o+n*i;return{x:a,y:s}}function k(t){var n=-1.5*I,e=I,r=.5*I,i=I,o=-1.5*I,a=3*I,s=O(n,e,45*t),c=O(r,i,45*t),u=O(o,a,45*t);return function(t,n){return new P(y(t,n,s.x,s.y,c.x,c.y,u.x,u.y)+N,.6,.9)}}function A(t,n){for(var e=[],r=0;r<8;r++)e.push(k(r)(t,n));var i=new P(_(t,n,0,0,E),.6,.9),o=M(w(e),i);return o}var C=function(){function t(n,e){Object(c["a"])(this,t),this.config=e,this.canvas=n,this.canvasCtx=this.canvas.getContext("2d"),this.canvasCtx.imageSmoothingEnabled=!1,this.canvasCtx.canvas.width=this.config.WIDTH,this.canvasCtx.canvas.height=this.config.HEIGHT,this.abort=!1}return Object(u["a"])(t,[{key:"run",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this.canvasCtx.clearRect(0,0,this.config.WIDTH,this.config.HEIGHT);for(var e=this,r=0;r<n;r+=1)for(var i=function(r){for(var i=0;i<n;i+=1)for(var o=function(n){var i=n/t.config.WIDTH-.5,o=1-r/t.config.HEIGHT-.5;setTimeout((function(){if(!e.abort){var t=Math.floor(Math.min(255*e.sample(i,o),255));e.draw(n,r,t,t,t)}}))},a=i;a<t.config.WIDTH;a+=n)o(a)},o=r;o<this.config.HEIGHT;o+=n)i(o)}},{key:"draw",value:function(t,n,e,r,i){this.canvasCtx.fillStyle="rgb(".concat(e,", ").concat(r,", ").concat(i,")"),this.canvasCtx.fillRect(t,n,1,1)}},{key:"sample",value:function(t,n){for(var e=0,r=0;r<this.config.N;r++){var i=l*(r+2*(Math.random()-.5))/this.config.N;e+=this.trace(t,n,Math.cos(i),Math.sin(i))}return e/this.config.N}},{key:"scene",value:function(t,n){return A(t,n)}},{key:"trace",value:function(t,n,e,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0,a=0;a<this.config.MAX_STEP&&o<this.config.MAX_DISTANCE;a++){var s=t+e*o,c=n+r*o,u=this.scene(s,c);if(u.sd<this.config.EPSILON){var l=u.emissive;if(i<m&&u.reflectivity>0){var v=void 0,h=void 0,p=void 0,d=void 0,g=void 0;g=this.gradient(s,c),v=g.nx,h=g.ny,g=this.reflect(e,r,v,h),p=g.rx,d=g.ry,l+=u.reflectivity*this.trace(s+v*f,c+h*f,p,d,i+1)}return l}o+=u.sd}return 0}},{key:"reflect",value:function(t,n,e,r){var i=2*(t*e+n*r),o=t-i*e,a=n-i*r;return{rx:o,ry:a}}},{key:"gradient",value:function(t,n){var e=(this.scene(t+this.config.EPSILON,n).sd-this.scene(t-this.config.EPSILON,n).sd)*(.5/this.config.EPSILON),r=(this.scene(t,n+this.config.EPSILON).sd-this.scene(t,n-this.config.EPSILON).sd)*(.5/this.config.EPSILON);return{nx:e,ny:r}}},{key:"refract",value:function(t,n,e,r,i,o){var a=t*e+n*r,s=1-i*i*(1-a*a);if(s<0)return 0;var c=i*a+Math.sqrt(s);return o.rx=i*t-c*e,o.ry=i*n-c*r,1}}]),t}(),H={name:"RayCanvas",data:function(){return{instance:null,showBtn:!0,aborted:!1,config:null,input_resolution:g,input_N:p,input_MAX_STEP:d}},methods:{preset:function(t){t=t||0;var n={0:[8,4],1:[8,8],2:[16,16],3:[32,32]};this.input_N=n[t][0],this.input_MAX_STEP=n[t][1]},draw:function(){this.config={MAX_DISTANCE:v,EPSILON:h,N:parseInt(this.input_N),MAX_STEP:parseInt(this.input_MAX_STEP),WIDTH:parseInt(this.input_resolution),HEIGHT:parseInt(this.input_resolution)},this.instance=new C(this.$refs.canvas,this.config),this.showBtn=!1;var t=this;setTimeout((function(){t.instance.run()}))},abort:function(){this.aborted=!0,this.instance.abort=!0}}},j=H,R=(e("135e"),e("2877")),X=Object(R["a"])(j,a,s,!1,null,"1d77fad9",null),D=X.exports,L={name:"app",components:{RayCanvas:D}},q=L,G=Object(R["a"])(q,i,o,!1,null,null,null),W=G.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(W)}}).$mount("#app")},ac8f:function(t,n,e){t.exports=e.p+"img/as.646ea0e4.png"},dd9d:function(t,n,e){}});
//# sourceMappingURL=app.a18d249c.js.map